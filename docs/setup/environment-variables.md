# 環境変数の管理

## 概要

このドキュメントでは、プロジェクトでの環境変数の管理方法について説明します。環境変数は、シークレット情報やデプロイ環境ごとに異なる設定を管理するために使用されます。

## 環境変数の管理方針

1. **dotenv (.env) ファイルを使用**
   - 開発環境ではプロジェクトルートの `.env` ファイルから環境変数を読み込む
   - `.env.sample` ファイルに必要な環境変数の例を記載（実際の値は含めない）
   - 実際の値が入った `.env` ファイルは Git 管理外とし、`.gitignore` に追加する

2. **環境変数の種類**
   - シークレット情報（API キー、パスワードなど）
   - 環境固有の設定（開発/ステージング/本番環境の識別子など）
   - サービス接続情報（データベース接続情報など）

3. **複数環境への対応**
   - 開発環境: `.env` ファイル
   - CI/CD: CI/CD システムの環境変数設定機能を使用
   - 本番環境: サーバー環境変数または管理サービスの環境変数設定を使用

## 環境変数の取り扱い

### 開発者向けの手順

1. リポジトリをクローンしたら、`.env.sample` をコピーして `.env` ファイルを作成する
   ```bash
   cp .env.sample .env
   ```

2. `.env` ファイルに実際の値を設定する

3. 注意点:
   - `.env` ファイルをコミットしないこと
   - シークレット情報をソースコードにハードコーディングしないこと
   - 他の開発者と環境変数を共有する場合は、安全な方法（パスワードマネージャーなど）を使用すること

### 環境変数の読み込み方法

各言語での環境変数の読み込み方法の例:

#### Python
```python
import os
from dotenv import load_dotenv

# .env ファイルから環境変数を読み込む
load_dotenv()

# 環境変数を取得
api_key = os.getenv('API_KEY')
```

#### Node.js
```javascript
require('dotenv').config();

// 環境変数を取得
const apiKey = process.env.API_KEY;
```

## 必要なライブラリ

- Python: `python-dotenv`
  ```bash
  pip install python-dotenv
  ```

- Node.js: `dotenv`
  ```bash
  npm install dotenv
  ```

## セキュリティ上の注意点

- 環境変数にはシークレット情報を含めることができるため、適切に保護する
- 開発マシンの `.env` ファイルを定期的にバックアップする（安全な方法で）
- 環境変数の内容をログに出力しない
- 環境変数の値に機密情報が含まれる場合は、使用後にできるだけメモリから消去する

## ベストプラクティス

- 環境変数名は大文字とアンダースコアを使用する（例: `DATABASE_URL`）
- 環境変数は特定の目的ごとにグループ化する（例: `DB_HOST`, `DB_PORT` など）
- 環境変数が存在しない場合のデフォルト値を設定する
- 環境変数の値は定期的にローテーションする（特にシークレット情報の場合）

## 関連ドキュメント

- [開発ワークフロー](./development-workflow.md)
- [コミット戦略](./commit-strategy.md)