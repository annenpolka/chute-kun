# ADR-004: 技術スタックの方向性決定

## ステータス
提案

## 日付
2025-03-01

## コンテキスト
TaskChuteアプリケーションの実装にあたり、様々な技術オプションを評価しました（docs/decisions/technology-evaluation.md参照）。追加の要件明確化により、オフライン動作は必須ではなく、外部連携はTodoist APIのみであることが確認されました。これにより、技術選定の優先順位が変更されます。

## 決定
以下の方向性でTaskChuteアプリケーションの技術スタックを検討します：

1. **フロントエンド**: TypeScript + React + Next.js
2. **スタイリング**: Tailwind CSS
3. **状態管理**: React Context + Hooks（必要に応じてZustandなど検討）
4. **APIクライアント**: TanStack Query (React Query)
5. **デプロイ**: Vercel
6. **LLM API**: OpenAI API（初期実装）、後にAnthropicオプションも追加

## 根拠

1. **開発効率とエコシステム**:
   - React + TypeScriptは広く採用されており、ドキュメントやリソースが豊富
   - Next.jsはAPI RoutesによるBFF実装も容易で、オーバーヘッドが少ない
   - TanStack QueryはAPIデータ取得と状態管理を簡素化

2. **シンプルな実装とデプロイ**:
   - Vercelによるデプロイは設定が最小限で自動化されている
   - オフライン対応が不要なため、複雑なデータ同期メカニズムが不要
   - NextAuth.jsによる認証機能の追加も容易

3. **拡張性と保守性**:
   - TypeScriptによる型安全性で保守性が向上
   - Next.jsのFile System Routingでコード構造が明確
   - モジュール分割が容易で、テスト容易性も高い

## 影響

1. **肯定的影響**:
   - 広く採用されている技術スタックによる開発速度の向上
   - シンプルなアーキテクチャによるメンテナンス性の向上
   - デプロイと運用の簡素化

2. **否定的影響**:
   - オフライン動作が後から必要になった場合の実装コスト
   - Reactのバンドルサイズがやや大きい（Next.jsで最適化可能）
   - サーバー側の実装が増えた場合のコスト増加の可能性

## 実装アプローチ

1. **最小実装から始める**:
   - Todoistタスク取得と表示機能
   - LLMによるタイムブロック生成の基本機能
   - シンプルなUI実装

2. **段階的な機能追加**:
   - タスク予測機能とユーザーフィードバック
   - UI改善と使い勝手向上
   - パフォーマンス最適化

3. **アーキテクチャの進化**:
   - 機能ごとのモジュール分割
   - LLM APIのラッパー抽象化（プロバイダー切り替え可能に）
   - 必要に応じたサーバーサイド機能の追加

## 代替案と検討事項

1. **Svelte + SvelteKit**:
   - より小さなバンドルサイズと高速な実行
   - エコシステムがやや小さい
   - 学習コストとリソース不足のリスク

2. **Remix**:
   - 優れたUXとサーバー連携
   - まだ発展途上のフレームワーク
   - 運用実績の少なさ

3. **純粋なクライアントサイド実装**:
   - APIキーの漏洩リスク
   - 処理の制約

これらの代替案は、実装開始後のプロトタイピングフェーズで再評価し、必要に応じて方向性を修正します。

## 関連
- docs/decisions/technology-evaluation.md（技術選定評価）
- docs/processes/decisions-log.md（2025-03-01の決定項目）
- docs/adr/ADR-003-Serverless-Architecture.md（サーバーレスアーキテクチャ）